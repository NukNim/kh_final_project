<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "mybatis-3-mapper.dtd" >
<mapper namespace="aplicant">
	
	<select id="aplicantAll" resultType="_int">
		select count(*) 
		from BUSINESS_APPLICANT ba 
		join RECRUIT_REGIST rr on ba.ra_num = rr.ra_num
		where rr.user_id = #{userId}
	</select>
	
	<select id="aplicantList" resultType="kh.com.job.business.model.dto.BsAplicantDto">
	select  ba.ba_num, ba.user_id, ba.resume_no
        , ur.resume_title, ur.resume_act,  ua.apply_date
        , ba.result_type
	from BUSINESS_APPLICANT ba 
	join user_resume ur ON ba.RESUME_NO = ur.RESUME_NO
	join user_apply ua ON ba.ba_num = ua.ba_num
	where ba.ra_num = #{raNum}
	</select>
	
	<select id="recruitList" resultType="kh.com.job.business.model.dto.BsRecruitAplicantDto">
	select rr.ra_num
		, rr.ra_title
		, (select count(*) from BUSINESS_APPLICANT ba where ba.ra_num = rr.ra_num and result_type = 'N') as failconut
		, (select count(*) from BUSINESS_APPLICANT ba where ba.ra_num = rr.ra_num and result_type = 'Y') as passconut
		, (select count(*) from BUSINESS_APPLICANT ba where ba.ra_num = rr.ra_num ) as aplicount
	from recruit_regist rr
	where rr.user_id = #{userId}
	</select>
	
</mapper>