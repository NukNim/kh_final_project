<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "mybatis-3-mapper.dtd" >
<mapper namespace="admin">

	<select id="accountmgr" resultType="pdto">
		select * from USER_TABLE
		WHERE USER_ROLE IN ('ROLE_A', 'ROLE_AM')
		ORDER BY USER_BIRTH DESC
	</select>  
	
	<select id="selectUser" resultType="kh.com.job.admin.model.dto.AdUserDto">
	  	select USER_ID, USER_PW, USER_PHONE, USER_BIRTH, USER_EMAIL, USER_NAME, USER_ROLE from USER_TABLE
	  	WHERE USER_ID = #{userId}
	</select>
	
		<select id="checkUser" resultType="kh.com.job.admin.model.dto.AdUserDto">
	  	select USER_PW from USER_TABLE
	  	WHERE USER_ID = #{userId}
	</select>
	
	
	
	<select id="idCheck" resultType="_int">
	  	select count(USER_ID) from USER_TABLE
	  	WHERE USER_ID = #{userId}
	</select>
	
	<insert id="insertAccount">
		INSERT INTO USER_TABLE (USER_ID, USER_PW, USER_PHONE, USER_BIRTH, USER_EMAIL, USER_NAME, USER_ROLE, TERMS_ACT, TERMS_DATE, TERMS_PERIOD)
		VALUES (#{userId}, #{userPw}, #{userPhone}, CURRENT_TIMESTAMP, #{userEmail}, #{userName}, #{userRole}, 'Y', CURRENT_TIMESTAMP, 60)
	</insert>
		
	<delete id="deleteAccount">
		DELETE FROM USER_TABLE WHERE USER_ID = #{userId}
	</delete>
	
	<!-- 직접 삭제 할지 계정 비활성화 시킬지 고민 -->
	<update id="deleteAccoint2">
		UPDATE USER_TABLE SET USER_ACT WHERE USER_ID = #{userId}
	</update>
	
	<update id="updateManager">
		UPDATE USER_TABLE
		<set>
			<if test= 'userPw != null and userPw != ""'>
			USER_PW = #{userPw},
			</if>
			<if test= 'userName != null and userName != ""'>
			USER_NAME = #{userName},
			</if>
			<if test= 'userPhone != null and userPhone != ""'>
			USER_PHONE = #{userPhone},
			</if>
			<if test= 'userEmail != null and userEmail != ""'>
			USER_EMAIL = #{userEmail},
			</if>
			<if test= 'userRole != null and userRole != ""'>
			USER_ROLE = #{userRole},
			</if>
		</set>
		WHERE USER_ID = #{userId}
	</update>
  
</mapper>
