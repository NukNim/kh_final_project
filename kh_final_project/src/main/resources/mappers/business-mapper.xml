<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "mybatis-3-mapper.dtd" >
<mapper namespace="business">

<!-- 회원정보 불러오기 -->
    <select id="viewAccount" resultType="budto">
        SELECT *
        FROM USER_TABLE
        WHERE USER_ID = #{userId}
    </select>
    

<!-- account -->
    
	<!-- 회원정보 수정하기 -->
    <update id="updateAccount">
        UPDATE USER_TABLE SET
        BS_LICENSE = #{bsLicense},
        BS_MAIN_PHONE = #{bsMainPhone},
        ADDRESS_POSTCODE = #{addressPostcode},
        ADDRESS_ROAD = #{addressRoad},
        ADDRESS_JIBUN = #{addressJibun},
        ADDRESS_DETAIL = #{addressDetail}
        WHERE USER_ID = #{userId}
    </update>
    
    <!-- //todo비밀번호 수정하기-->
    <update id="updatePassword">
        UPDATE USER_TABLE SET
        USER_PW = #{userPw}
        WHERE USER_ID = #{userId}
    </update>    
    
    <!-- //todo 회원 프로필 이미지 수정하기 -->
    <update id="updateUimage" >
        UPDATE tb_user SET
        USER_PIC = #{userPic}
        WHERE user_id = #{userId}
    </update>
	
    <!-- //todo회원비밀번호  불러오기-->
    <select id="getUserPw" resultType="budto">
        SELECT USER_ID, USER_PW
        FROM USER_TABLE
        WHERE USER_ID = #{userId}
    </select>
    
      
    
 <!-- 워크넷API data insert -->
   	<insert id="apiInsert" parameterType="brdto">
			insert INTO RECRUIT_REGIST
			(RA_NUM, RECRUIT_TYPE, COMPANY_NAME, BUSINO, USER_EDUCATION
					, SALARY, MIN_SALARY, MAX_SALARY
					, REGIST_DATE, CLOSE_DATE, RA_TITLE
					, CAREER, HOLIDAY_TYPE, EMP_TYPE_CODE) 
			VALUES(RECRUIT_REGIST_SEQ.NEXTVAL, #{recruitType}, #{companyName}, #{busino}, #{userEducation}
					, #{salary}, #{minSalary}, #{maxSalary}
 			        , #{registDate}, #{closeDate}, #{raTitle}
 			        , #{career}, #{holidayType}, #{empTypeCode})
	</insert>
	
	<!-- 직업 카테고리 항목 가져오기 -->
	<select id="getCateList" parameterType="string" resultType="kh.com.job.admin.model.dto.AdCategoryDto">
		SELECT * FROM JA_CATEGORY where CATEGORY_TYPE = #{categoryType} AND CATEGORY_DEPT ='2'
	</select>
	
	<!-- 채용공고 작성 -->
	<insert id="insertRecruit">
		insert INTO RECRUIT_REGIST
			(RA_NUM, COMPANY_NAME, RECRUIT_TYPE,USER_EDUCATION, USER_ID
					, SALARY, MIN_SALARY, MAX_SALARY
					, REGIST_DATE, CLOSE_DATE
					, CAREER, HOLIDAY_TYPE, EMP_TYPE_CODE
					, RA_TITLE, RA_CONTENT
					, RA_EXTRA_DOCUMENT,RA_PROGRESS, RA_ADMISSION) 
			VALUES(RECRUIT_REGIST_SEQ.NEXTVAL, #{companyName}, #{recruitType}, #{userEducation}, #{userId}
					, #{salary}, #{minSalary}, #{maxSalary}
 			        , #{registDate}, #{closeDate}
 			        , #{career}, #{holidayType}, #{empTypeCode}
 			        , #{raTitle}, #{raContent}
 			        , #{raExtraDocument}, 'N', 'N')
	</insert>
	
	<!-- 채용공고 미승인 리스트 -->
	<select id="recruitAdmission" resultType="kh.com.job.business.model.dto.BsRecruitDto">
		SELECT * FROM RECRUIT_REGIST
		WHERE USER_ID = #{userId} 
		AND RA_ADMISSION = 'N'
		AND CLOSE_DATE > SYSDATE
	</select>
	<!-- 채용공고 등록 리스트 -->
	<select id="recruitProgress" resultType="kh.com.job.business.model.dto.BsRecruitDto">
		SELECT * FROM RECRUIT_REGIST
		WHERE USER_ID = #{userId} 
		AND RA_ADMISSION IN ('P', 'Y')
		AND CLOSE_DATE > SYSDATE
	</select>
</mapper>